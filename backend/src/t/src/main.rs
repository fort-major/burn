use candid::Principal;
use ic_verifiable_credentials::{
    issuer_api::CredentialSpec, validate_ii_presentation_and_claims, VcFlowSigners,
};
use std::time::{Duration, SystemTime};

pub fn main() {
    let _pk = "[48, 129, 130, 48, 29, 6, 13, 43, 6, 1, 4, 1, 130, 220, 124, 5, 3, 1, 2, 1, 6, 12, 43, 6, 1, 4, 1, 130, 220, 124, 5, 3, 2, 1, 3, 97, 0, 129, 76, 14, 110, 199, 31, 171, 88, 59, 8, 189, 129, 55, 60, 37, 92, 60, 55, 27, 46, 132, 134, 60, 152, 164, 241, 224, 139, 116, 35, 93, 20, 251, 93, 156, 12, 213, 70, 217, 104, 95, 145, 58, 12, 11, 44, 197, 52, 21, 131, 191, 75, 67, 146, 228, 103, 219, 150, 214, 91, 155, 180, 203, 113, 113, 18, 248, 71, 46, 13, 90, 77, 20, 80, 95, 253, 116, 132, 176, 18, 145, 9, 28, 95, 135, 185, 136, 131, 70, 63, 152, 9, 26, 11, 170, 174]";
    let pk = _pk
        .trim_start_matches("[")
        .trim_end_matches("]")
        .split(",")
        .map(|chunk| chunk.trim().parse().expect("Unable to parse ic root key"))
        .collect::<Vec<u8>>();

    let signers = VcFlowSigners {
        ii_canister_id: Principal::from_text("rdmx6-jaaaa-aaaaa-aaadq-cai").unwrap(),
        ii_origin: "https://identity.ic0.app/".into(),
        issuer_canister_id: Principal::from_text("qgxyr-pyaaa-aaaah-qdcwq-cai").unwrap(),
        issuer_origin: "https://id.decideai.xyz".into(),
    };

    let spec = CredentialSpec {
        credential_type: format!("ProofOfUniqueness"),
        arguments: None,
    };

    let duration_since_epoch = SystemTime::now()
        .duration_since(SystemTime::UNIX_EPOCH)
        .unwrap();
    let timestamp_nanos = duration_since_epoch.as_nanos(); // u128

    let jwt = "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJpc3MiOiJkaWQ6aWNwOnFneHlyLXB5YWFhLWFhYWFoLXFkY3dxLWNhaSIsInZwIjp7IkBjb250ZXh0IjoiaHR0cHM6Ly93d3cudzMub3JnLzIwMTgvY3JlZGVudGlhbHMvdjEiLCJ0eXBlIjoiVmVyaWZpYWJsZVByZXNlbnRhdGlvbiIsInZlcmlmaWFibGVDcmVkZW50aWFsIjpbImV5SnFkMnNpT25zaWEzUjVJam9pYjJOMElpd2lZV3huSWpvaVNXTkRjeUlzSW1zaU9pSk5SSGQzUkVGWlMwdDNXVUpDUVVkRWRVVk5Ra0ZuVFhOQlFXOUJRVUZCUVVGQlFVRkNkMFZDUlMxR2NrSnFWR1YwVDNac1psRXdhekF4UkhjM1FWaFlTV3hsTXpCME9GOWZTbGhTYzFWSE5YVllWU0o5TENKcmFXUWlPaUprYVdRNmFXTndPbkprYlhnMkxXcGhZV0ZoTFdGaFlXRmhMV0ZoWVdSeExXTmhhU0lzSW1Gc1p5STZJa2xqUTNNaWZRLmV5SmxlSEFpT2pFM01qWTNOak0zTVRVc0ltbHpjeUk2SW1oMGRIQnpPaTh2YVdSbGJuUnBkSGt1YVdNd0xtRndjQzhpTENKdVltWWlPakUzTWpZM05qSTRNVFVzSW1wMGFTSTZJbVJoZEdFNmRHVjRkQzl3YkdGcGJqdGphR0Z5YzJWMFBWVlVSaTA0TEhScGJXVnpkR0Z0Y0Y5dWN6b3hOekkyTnpZeU9ERTFNakE1TlRRMk5ERTBMR0ZzYVdGelgyaGhjMmc2WkRFME9ETTJOamN4WXpReE9UTXdOR1ZtTVRreU5EZzFPV0UyWVRrNFkyUmlOamRrWkRsa09Ua3lZamhtTjJVeE9URmpaV1F3T0RoaFlUSXlOVEJpTWlJc0luTjFZaUk2SW1ScFpEcHBZM0E2YnpaaGNUTXRjVEl5WVRZdGFYYzBkR2N0YUdka2IzVXRaRzAzYkdFdFpua3pkVFF0Wm1Sa2RtMHRlbVZzTjI4dFoyRm5hbTR0WkdsbGNYVXRZbUZsSWl3aWRtTWlPbnNpUUdOdmJuUmxlSFFpT2lKb2RIUndjem92TDNkM2R5NTNNeTV2Y21jdk1qQXhPQzlqY21Wa1pXNTBhV0ZzY3k5Mk1TSXNJblI1Y0dVaU9sc2lWbVZ5YVdacFlXSnNaVU55WldSbGJuUnBZV3dpTENKSmJuUmxjbTVsZEVsa1pXNTBhWFI1U1dSQmJHbGhjeUpkTENKamNtVmtaVzUwYVdGc1UzVmlhbVZqZENJNmV5SkpiblJsY201bGRFbGtaVzUwYVhSNVNXUkJiR2xoY3lJNmV5Sm9ZWE5KWkVGc2FXRnpJam9pYUc1bmVta3RjbTgwTTNRdGMySmhhV1V0Wldka1pXTXRaWGt6ZFRVdGNYbHpjall0ZEhKcFpuTXROMmR0WldRdGVYZDRkek10Y25Sa05UY3RhMkZsSW4xOWZYMC4yZG4zb210alpYSjBhV1pwWTJGMFpWa0VyOW5aOTZOa2RISmxaWU1CZ3dHREFZSUVXQ0NtV3ZvNDRpUWlpR09vbnJ0enotVmMtY0MxNXNqNGRXdzVpTTE0T1haZWk0TUNTR05oYm1semRHVnlnd0dEQVlNQmd3SktBQUFBQUFBQUFBY0JBWU1CZ3dHREFrNWpaWEowYVdacFpXUmZaR0YwWVlJRFdDQXR2QnhZQU1qSW5xYllTRFJxMTNrd2VhMTVoV3F6Zm1fMFNfMW5qblFhVG9JRVdDRFk5azk2X0thbFhVN20zdG13SUF1c1psSEs5TWVoa2dJU3RhQThtX0hmTm9JRVdDQkdwbW8zVjVEY3d3aXJqNTdTcE9MY3NXek5QMGtINUJKNDFMaUhacV9pSDRJRVdDQ0VkWEdNMC1PSlY2VHRSSnYzdjdZbE1fanYxVC1JdlozQzFVckQ2NDJ0dTRJRVdDQmxUZ0plODNaVVhiQVRDT2tXSE9YNElCZ18waWJjRVlhd2NnYzduMWFkUzRJRVdDQ1ZkMFV4c0RPZHpZY0pWM09tRk5iVndXVHdxaFpSVjhaTlh4YXMyUEZ5TjRJRVdDQkpJTEhTamhneXRhRnkyOWJ0LUdIU0FBUmNORXlmV0hrZjN0aXAwa3pDVDRNQmdnUllJT0QxNmFBaXNmenpmenJoTm10NzVkdjRfQkc1UzhSZGkwbHVUQkFadW4zemd3SkVkR2x0WllJRFNkNno2cUdrdEt6N0YybHphV2R1WVhSMWNtVllNTGNVcFRpMEtIMExpV2YwWXNreWprVTVlcGkwMXpocHZqYklTY2duOUthb2VhN0xuVWJYMjVKVmMtUVcwajBkcldwa1pXeGxaMkYwYVc5dW9tbHpkV0p1WlhSZmFXUllIVVBjcnhHQTI0TDlwd2pPT3NlZ09tQmdxOTRUNlZSc1lPak01bDBDYTJObGNuUnBabWxqWVhSbFdRS1UyZG4zb21SMGNtVmxnd0dDQkZnZ3RTZlRBSVY2YU10NERuSVcyV0QxYWZSVlN1bG8wVUpSajAtME9nT1lPNVNEQVlNQmdnUllJT1lPLXdtOGQ0Z1Jtb253NW83dHVxZklFck9YTnJrMW94Y045OGJLdzU2ZGd3SkdjM1ZpYm1WMGd3R0RBWU1CZ2dSWUlEb00xUGVRcTdWQ0RHTjZrbkpJeDZneUV1T3FVNi1PTmJnSFNLRUhKa1lQZ3dHQ0JGZ2dSbXB3S0d6NXJPbUFIS1UtSXE5dTRGbWdsUDFnU1lZRzFJUzJoVUJZTUgyREFZTUJnZ1JZSUlzdmJCVUhpdVRUdVRSd2tWeWxQamN6Sl9OLXAwdWh1QmQ5bUd1M216R3Vnd0pZSFVQY3J4R0EyNEw5cHdqT09zZWdPbUJncTk0VDZWUnNZT2pNNWwwQ2d3R0RBazlqWVc1cGMzUmxjbDl5WVc1blpYT0NBMWd5MmRuM2dvSktBQUFBQUFBQUFBY0JBVW9BQUFBQUFBQUFCd0VCZ2tvQUFBQUFBaEFBQUFFQlNnQUFBQUFDSF9fX0FRR0RBa3B3ZFdKc2FXTmZhMlY1Z2dOWWhUQ0JnakFkQmcwckJnRUVBWUxjZkFVREFRSUJCZ3dyQmdFRUFZTGNmQVVEQWdFRFlRQ0lHYXFvYU5vMVBqUlJ1NWRuWF8tcWNSNDhIQkl3NDU0ZjdyQ3ZuLUEtWjhrNVB3alhsc0hrSzFLS3UxX0xRVmtaa29Td0FKYjIydnFUdEhFZkdzWmZXVXRueml3TE5YRU9BNUhGUWt5M1ZIZWFIR0NFOXVkN1dFNThqUGYtblltQ0JGZ2dMRkhiZTFaUXQ2UGJ1NFV3cDBTY3h2a0JSSGVMWXZJUFBDYlhMcFhsQnBpQ0JGZ2dhV0h2RTN3cTdnc0Vad2d1OXRQQkxBUHBNQk8yQXFUTFloUW5Ea2hJWV9HQ0JGZ2c2UGRaRTBKcUZwbXBmOWlxVzJJYmI0ZWVHaW9OZ2w3T2syVUdDQmJUaGVDREFrUjBhVzFsZ2dOSnl1Njg4dGJObGZzWGFYTnBaMjVoZEhWeVpWZ3dpNXkzM2NZeXB3WUJENVExRkp2cTYwVTlQcmF0Z2IydTl3OVVlMUpKa2RzMTQwU1RWYzlFUk9kOU54SV9jcVo4WkhSeVpXV0RBWUlFV0NCZHQ1ZGFadGZRTGhSTE5ma2ZmSWpKQTNXVGZjbHJtMjVaWEFjZzZSdk9sWU1DUTNOcFo0TUJnZ1JZSUJ6V1lOZ0FoZmF1V1lTejlxSmFHckpUQmxSdW5ONjVKUTdyTms5OXFhRmJnd0dDQkZnZzhnTkQ3d1ZoRWd3QmdXSGktYk8xU25WSWUtaEY3bGdfdnhhZXUzeF9FM0tEQVlNQmd3R0RBbGdnek9UODlhYkFFR2NMRmNwcVM5dUZ5ZHlWYmhWNlUzci11LVh4bS0xMnpONkRBWU1DV0NCeWFqbzB5TFRLdXlNbFBWcklkVngzMjRLWVp4cU5HMS1PNWJNcldPVXl6SUlEUUlJRVdDQ0x2STZIWmVlNXdXbTZSTXhyTV9hUC1mQVpfLWlySGtuV1lXS3ZDYlBJeFlJRVdDQW1HNlVoTzhwaF80M2gtcjZ5Ynd0MVhsRWFEVnNNaGEwY3BscC0zWGVBbG9JRVdDQWhNbVpvcDZDX2QzejJQWmtXc01hNmpGNTJqaTlWdlhDT1dWVFV5aURKMW9JRVdDQTJpWWF4VENZam1CN0txNnFhamZFeDlCUnU2SzNibHBuSk5rdzA0Y0hqYnciLCJleUpxZDJzaU9uc2lhM1I1SWpvaWIyTjBJaXdpWVd4bklqb2lTV05EY3lJc0ltc2lPaUpOUkhkM1JFRlpTMHQzV1VKQ1FVZEVkVVZOUWtGblRYTkJRVzlCUVVGQlFVRlFRVmx5VVVWQ01ucGtaREl0YkcxeFRHSldjSGRsVjFJeFN6aFFabmcxTmxKUmRWOXJNVGN3VGs1eFMwVk1kVmx0VVNKOUxDSnJhV1FpT2lKa2FXUTZhV053T25GbmVIbHlMWEI1WVdGaExXRmhZV0ZvTFhGa1kzZHhMV05oYVNJc0ltRnNaeUk2SWtsalEzTWlmUS5leUpsZUhBaU9qRTNNalkzTmpNM01qWXNJbWx6Y3lJNkltaDBkSEJ6T2k4dmFXUXVaR1ZqYVdSbFlXa3VlSGw2THlJc0ltNWlaaUk2TVRjeU5qYzJNamd5Tml3aWFuUnBJam9pYUhSMGNITTZMeTlwWkM1a1pXTnBaR1ZoYVM1NGVYb3ZJaXdpYzNWaUlqb2laR2xrT21samNEcG9ibWQ2YVMxeWJ6UXpkQzF6WW1GcFpTMWxaMlJsWXkxbGVUTjFOUzF4ZVhOeU5pMTBjbWxtY3kwM1oyMWxaQzE1ZDNoM015MXlkR1ExTnkxcllXVWlMQ0oyWXlJNmV5SkFZMjl1ZEdWNGRDSTZJbWgwZEhCek9pOHZkM2QzTG5jekxtOXlaeTh5TURFNEwyTnlaV1JsYm5ScFlXeHpMM1l4SWl3aWRIbHdaU0k2V3lKV1pYSnBabWxoWW14bFEzSmxaR1Z1ZEdsaGJDSXNJbEJ5YjI5bVQyWlZibWx4ZFdWdVpYTnpJbDBzSW1OeVpXUmxiblJwWVd4VGRXSnFaV04wSWpwN0lsQnliMjltVDJaVmJtbHhkV1Z1WlhOeklqcDdmWDE5ZlEuMmRuM29tdGpaWEowYVdacFkyRjBaVmtHRk5uWjk2TmtkSEpsWllNQmd3R0RBWUlFV0NDbVd2bzQ0aVFpaUdPb25ydHp6LVZjLWNDMTVzajRkV3c1aU0xNE9YWmVpNE1DU0dOaGJtbHpkR1Z5Z3dHQ0JGZ2d5alpTNzFMUWtmMmNCTG9wcV95UWVNRC1aeGFKaFB4VEFnOFR0U0h5VG4tREFZTUJnZ1JZSUJQTXEtOERYWkUzNlpraW9vb1lxRUloNENkZUlLRnZTTm1oNHNrVFVvOHNnd0dDQkZnZ1F4MnNGbFI5X2I3QVJMaklvTmR1QVU5T2JIbUhRaWJ0ZjZUd1NfcHJoeE9EQVlJRVdDQVhtWmwzZjVBS2dDc0xmalpfOWhFQmVSSGx0RUJMOUtSYkZ1MVAtZENtQ0lNQmd3R0RBWU1CZ3dHQ0JGZ2dTc3hYYXpOWFZTTjNyWG1HY1M0SHhPWXF2R1ZqbndISjduaUhRX0pZdHppREFZTUJnd0dDQkZnZ3ItUGl5M3JoRVdFVHZQSndmRkZkdWJ2QW4tOS12NW5GWFJmV0pSZE0wUGFEQWtvQUFBQUFBUEFZclFFQmd3R0RBWU1DVG1ObGNuUnBabWxsWkY5a1lYUmhnZ05ZSUdxZGVHR3MzOUJYZXBxVEFlTmZMSC1IaXM3SU5FUHdfTFFZOERYcGVDMThnZ1JZSUoyRjQwRmxqaTJqdmZRRG5rVUJSelBVSHQ0QjlPc0FtMUhSTjlFZW9QRjFnZ1JZSUdJeWFuVWh3Rkd1WDdPTGtCdElZTEVDUDBwakhHUUJvZ3JDS1pTbm9pS0dnZ1JZSU9MQjVtd2x5UnhLaGs3OG5pVVV2TmN1Z0NaSEZXNElodnA4Z2JRaEpaMGRnZ1JZSUZBblZiMjFURHpvanp4YXNMbDkzSHBCdlNtaDYzZUE5YUtLSkE0eEUtWGZnZ1JZSUtubmtibTE4S1BQSXFxclc4OXJpdGV0a2ZjVHg0Skt3NW96UXpHR29NV0lnZ1JZSUVNeVROQWNZSEZ5RGRlNkhIV0lJaU8wODlkYVc3dFF3RE1fOWJyY3dZZjJnZ1JZSUp0STRtcExGTW1ka25HQ3h3amhZaXZuOTdJakE3SENlLXdRblZ5NF83a05nZ1JZSUJRYV9XVHRrR2U4bUYyR2lQenFZWVIzcUpRdUJUODIxQzRfYmM5eU9lSDFnZ1JZSVBoVzJUYzFpMUZRanZUTXRkX3hKTFBZbFFrcXhCblMwc3R5TW5TY3ZUSDBnZ1JZSURlX3ZwLWhsSUZ1Y3JhMXdtZWE5VXpNUHRRVzUwbUI5NWpBMXptTkUxRzBnd0dDQkZnZ29NNEgwRGhXLUdIQjNmTHNaVlpYaXN4dWhnSjNIQkt1d04tZUJkUE5rc1NEQWtSMGFXMWxnZ05KbWUtUDM4VzByUHNYYVhOcFoyNWhkSFZ5WlZnd3N4aWJwbGVIM0pwSm1QLTh3akxjcmhTUEZMVDlvTXdNZzhNb0VPMzhRcnlPTlZsSHktSWpXdG55aUI5bG5LOXdhbVJsYkdWbllYUnBiMjZpYVhOMVltNWxkRjlwWkZnZE04TDU2Zy1PTEZQbTVVZG0yOGJPeU5wbmg3QVZRbUNwbVNYM3FBSnJZMlZ5ZEdsbWFXTmhkR1ZaQW4zWjJmZWlaSFJ5WldXREFZSUVXQ0E5LW9KcUYyanpKTExQeFVhSWp6VmpuWTVtWDc1d1BjSXBQbnJJOVIyQmg0TUJnd0dDQkZnZzhnWVBaUUVzaXJ6allZZzRpdUt4dDY0dWNQLUZVSmR3OFRKUmp5a3FKdUdEQWtaemRXSnVaWFNEQVlNQmd3R0NCRmdnT2d6VTk1Q3J0VUlNWTNxU2NrakhxRElTNDZwVHI0NDF1QWRJb1FjbVJnLURBWU1CZ2dSWUlGdWUzV1FJSW9vNVZzUzBGazdUMmV3NHI2dm1NeEQ0VGFlNWNBWGgtdU4xZ3dHQ0JGZ2dCZVFtMEE3ZGdsWmpkdkk3RmNQMGxiNkJyZVNsUmZRZk9ST09xUzU2S21HREFsZ2RNOEw1NmctT0xGUG01VWRtMjhiT3lOcG5oN0FWUW1DcG1TWDNxQUtEQVlNQ1QyTmhibWx6ZEdWeVgzSmhibWRsYzRJRFdCdloyZmVCZ2tvQUFBQUFBUEFBQUFFQlNnQUFBQUFBX19fX0FRR0RBa3B3ZFdKc2FXTmZhMlY1Z2dOWWhUQ0JnakFkQmcwckJnRUVBWUxjZkFVREFRSUJCZ3dyQmdFRUFZTGNmQVVEQWdFRFlRQ3pHMEJzbjJaSWFWcUlGVXJpNVBYLWg0ZzlTdGdjS0VURlZ4c3RrZFFCemRRSU51ZGpwOEdOekxoR0tiRFlDUGNVTERGMXZJSXgzQW05VTJOLV9XOGxhSUFUaGV5WFBUVG03dm5JeUNnS24wb1JRV09rT29WQWxCdWpaX0RIeXlpQ0JGZ2dxM1QwZWM3WWE1MlZCZUs2RkR4ZFBodzRPb3AtZkdpb1dnN0dhMFgydDBHQ0JGZ2dhV0h2RTN3cTdnc0Vad2d1OXRQQkxBUHBNQk8yQXFUTFloUW5Ea2hJWV9HQ0JGZ2cxeFNKc21USk9nVWdPMkpfNDFGUXhiNmFZSmk2cUhpdWE4UlpzdzduOHptREFrUjBhVzFsZ2dOSmdvbnA4ZnpWbFBzWGFYTnBaMjVoZEhWeVpWZ3doZDJUNHE3elplaXBBd0tsenR4X0FlSUVqMWdZUDFFQnh3MGc1R0hrc0YtQjItNE56OWk5RFdzWF9SUEZ3NnVkWkhSeVpXV0RBWUlFV0NDdWh2MFpFZnRKV2Jvc2J4RTBxa21pRVVqWVFGY2ZxcnB1V0VCeEpQVXdfNE1DUTNOcFo0TUNXQ0M5NU9teGdWb1pGWDJfb3B4NmVHanBaV2EzOFhVdUVCTGVtMHhDS0lZR0ZZTUNXQ0JJRy02MXgxQWdLS1haREhvUnktWHl0UzBoSGhJX0pCVFZrWHhMT3JXNHE0SURRQSJdfX0.";
    let my_id =
        Principal::from_text("o6aq3-q22a6-iw4tg-hgdou-dm7la-fy3u4-fddvm-zel7o-gagjn-diequ-bae")
            .unwrap();

    validate_ii_presentation_and_claims(&jwt, my_id, &signers, &spec, &pk, timestamp_nanos)
        .expect("Unable to validate");
}
